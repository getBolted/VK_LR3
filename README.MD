# Лабораторная работа №3 - Обработка COMTRADE файлов

COMTRADE общепринятый формат регистрации осциллограмм переходных процессов (аварий) в энергосистемах. Название образовано из четырех английских слов:
* COM mon (общепринятый)
* TRA nsient (переходный)
* D ata (данные)
* E xchange (обмен)

Формат стандартизует процесс получения, анализа и обмена осциллограмм различных аварий, испытаний (или передачи тестовых данных) между различными производителями оборудования и эксплуатирующими организациями.

Осциллограмма представляется двумя файлами с одинаковыми именами но разными расширениями (например osc1.cfg osc1.dat ):
* с расширением .cfg - информация о формате .dat, частота, продолжительность, количество каналов и их тип.
* с расширением .dat - записанные выборки в формате текста или бинарном формате.

## Файл с данными (*.dat)
Содежит выборки аналоговых и дискретных каналов. Файл называется так же как и конфигурационный файл, но имеет расширение .dat.
ФОРМАТ одной строки осциллограммы:

1-ое число: 	содержит номер выборки данных - целое число (отсчет от 1).
2-ое число: 	время в микросекундах от начала осциллограммы.
3-е и остальные: содержат величины, которые представляют аналоговые сигналы (напряжения и токи) и дискретные сигналы (их значения в момент выборки).

## Файл с конфигурацией (*.cfg)
Описывает настройки осцилографирования.Файлы конфигурации COMTRADE содержат следующую информацию:
1. название и обозначение станции:

    > station_name,id

    где:
    * station_name 	уникальное название регистратора
    * id 	уникальный номер регистратора

2. количество и тип каналов:

    > TT,nnt,nnt             (например 17,7A,7D)

    где:
    * ТТ 	общее количество каналов
    * nn 	количество канала определенного типа
    * t 	тип входа (А – аналоговый / В -дискретный)

3. имена каналов, модулей и коэффициенты преобразования, Каждому каналу соответствует строка вида:

    аналоговый канал:

    > nn,id,p,cccccc,uu,a,b,skew,min,max

    дискретный канал:

    > nn,id,m

    где:
    * nn 	номер канала
    * id 	идентификатор канала
    * р 	идентификатор фазы канала
    * сссссс 	цепь/компонент, который контролируется
    * uu 	единица измерения в канале (kV, kA, и т.д.)
    * а 	вещественное число (см. Примечание)
    * b 	вещественное число. (см. Примечание)
    * skew 	вещественное число. Сдвиг времени (в мкс) в канале с начала отсчета
    * min 	целое, равное минимальной величине (нижняя граница диапазона) для выборок этого канала.
    * max 	целое, равное максимальной величине (верхняя граница диапазона) для выборок этого канала.
    * m 	(0 или 1) нормальное состояние этого канала (относится только к дискретным каналам).

> Примечание
> В файле .dat значение x соответствует (ах+b). То есть:
> * a - калибровка
> * b - смещение

4. частота сети:

    > lf

    где:
    * lf 	частота сети в Гц (50 или 60)

5. частота дискретизации и число выборок при этой частоте; Общее количество частот дискретизации с последующим списком, содержащим каждую частоту дискретизации и номер последней выборки для данной скорости:

    > nrates
    > sssssl,endsampl
    > sssss2,endsamp2
    >…
    > sssssn,endsampn

    где:
    * nrates 	количество различных скоростей дискретизации в файле данных
    * sssss1-sssssn 	частота дискретизации в Гц
    * endsampl-endsampn 	номер последней выборки для данной скорости.

6. Две отметки дата/время:

    > mm/dd/yy,hh:mm:ss.ssssss для первого значен-ия в файле данных
    > mm/dd/yy,hh:mm:ss.ssssss для момента пуска.

    где:
    * mm 	месяц (01-12)
    * dd 	день месяца (01-31)
    * уу 	последние две цифры года
    * hh 	часы (00-23)
    * mm 	минуты (00-59)
    * ss.ssssss 	секунды (от 0 с до 59.999999 с)

7. тип файла:

    Идентифицируется как ASCII файл идентификатором ft:
    > ft

    где:
    ft 	ASCII или BINARY

## Рассчет действующей составляющей сигналов токов и напряжений

Для рассчета воспользуемся формулой быстрого преобразования Фурье:

![FFT](https://s0.wp.com/latex.php?latex=rms%3D%5Csqrt%7B%5Cfrac%7B1%7D%7BN%7D%5Csum%5Climits_%7Bi%3D1%7D%5EN+%7Bx%28i%29%7D%5E2%7D&bg=ffffff&fg=000&s=0&c=20201002)

где:
rms - действующее значение сигнала
N - количество дискретных отсчетов в 1 периоде сигнала 
x(i) - мгновенное значение сигнала, соответствующее i-ому отсчету
